DROP VIEW "public"."vw_campaign_publications";--> statement-breakpoint
CREATE VIEW "public"."vw_campaign_publications" AS (select count("publication_broadcasts"."id") as "broadcast_count", count("broadcast_views"."id") as "click_count", COALESCE(SUM("wallet_transactions"."value"), 0) as "total_exhausted_credits", "credit_allocations"."allocated", "campaign_publications"."creditAllocation", "campaign_publications"."campaign", "campaign_publications"."updatedAt", "campaign_publications"."id", "campaign_publications"."createdAt" from "campaign_publications" left join "campaigns" on "campaigns"."id" = "campaign_publications"."campaign" left join "publication_broadcasts" on "publication_broadcasts"."publication" = "campaign_publications"."id" left join "broadcast_views" on "broadcast_views"."publication" = "campaign_publications"."id" left join "credit_allocations" on "credit_allocations"."id" = "campaign_publications"."creditAllocation" left join "wallet_transactions" on ("wallet_transactions"."creditAllocation" = "campaign_publications"."creditAllocation" and "wallet_transactions"."status" = 'complete' and "wallet_transactions"."type" = 'reward') group by "credit_allocations"."id", "campaign_publications"."id");